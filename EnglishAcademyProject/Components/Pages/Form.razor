@page "/form/{CourseId}/{NameCourse}"
@using Havit.Blazor.Components.Web.Bootstrap
@using EnglishAcademyProject.Components.Class
@inject NavigationManager navigationManager

@rendermode InteractiveServer

<PageTitle>Matrícula</PageTitle>
<div class="bs-stepper">
    <div class="bs-stepper-header" role="tablist">
        <!-- your steps here -->
        <div class="step" data-target="#logins-part">
            <button type="button" class="step-trigger" role="tab" aria-controls="logins-part" id="logins-part-trigger">
                @if(stepForm == 0 || stepForm == 1 || stepForm == 2 || stepForm == 3 || stepForm == 4)
                {
                    <span class="bs-stepper-circle-selected ">1</span>

                }
                <span class="bs-stepper-label">Datos del Curso</span>
            </button>
        </div>
        <div class="line"></div>
        <div class="step" data-target="#information-part">
            <button type="button" class="step-trigger" role="tab" aria-controls="information-part" id="information-part-trigger">
                @if(stepForm == 0)
                {
                    <span class="bs-stepper-circle">2</span>

                }
                @if(stepForm == 1 || stepForm == 2 || stepForm == 3 || stepForm == 4)
                {
                    <span class="bs-stepper-circle-selected">2</span>
                }
                <span class="bs-stepper-label">Datos de Contacto</span>
            </button>
        </div>
        <div class="line"></div>
        <div class="step" data-target="#information-part">
            <button type="button" class="step-trigger" role="tab" aria-controls="information-part" id="information-part-trigger">
                @if(stepForm == 0 || stepForm == 1)
                {
                    <span class="bs-stepper-circle">3</span>

                }
                @if(stepForm == 2 || stepForm == 3 || stepForm == 4)
                {
                    <span class="bs-stepper-circle-selected">3</span>
                }
                <span class="bs-stepper-label">Datos de Interés</span>
            </button>
        </div>
        <div class="line"></div>
        <div class="step" data-target="#information-part">
            <button type="button" class="step-trigger" role="tab" aria-controls="information-part" id="information-part-trigger">
                @if(stepForm == 0 || stepForm == 1 || stepForm == 2)
                {
                    <span class="bs-stepper-circle">4</span>

                }
                @if(stepForm == 3 || stepForm == 4)
                {
                    <span class="bs-stepper-circle-selected">4</span>
                }
                <span class="bs-stepper-label">Aceptación condiciones legales</span>
            </button>
        </div>
        <div class="line"></div>

        <div class="step" data-target="#information-part">
            <button type="button" class="step-trigger" role="tab" aria-controls="information-part" id="information-part-trigger">
                @if(stepForm == 0 || stepForm == 1 || stepForm == 2 || stepForm == 3)
                {
                    <span class="bs-stepper-circle">5</span>

                }
                @if(stepForm == 4)
                {
                    <span class="bs-stepper-circle-selected">5</span>
                }
                <span class="bs-stepper-label">Datos Bancarios</span>
            </button>
        </div>
    </div>

</div>

<div class="cointaner" style="padding-top:2rem;">
    <div class="menu">
        <div class="main">
            <h1 style="text-align:center;padding:1rem;">@mainTitle </h1>
            <div class="row">
                <div class="col-sm-6">
                    <h5 style="text-align:center">Curso seleccionado </h5>

                    <HxInputText @bind-Value="@selectedCourse" Enabled="false"></HxInputText>
                </div>
                <div class="col-sm-6">
                    <h5 style="text-align:center">Precio del curso </h5>

                    <HxInputText TValue="int" @bind-Value="@price" Enabled="false"></HxInputText>

                </div>
            </div>

        </div>
        <hr>
        <div class="section">
            @if(stepForm == 0)
            {
                <div class="row">
                    <div class="col-sm-12" style="text-align:center;">
                        <HxInputText Label="Nombre del hijo/a a matricular *" @bind-Value="@form.sonsName"></HxInputText>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6" style="text-align:center;">
                        <HxInputDate CalendarIcon="BootstrapIcon.Calendar" Label="Fecha de Nacimiento *" @bind-Value="@form.sonsBirthday" />
                    </div>
                    <div class="col-sm-6" style="text-align:center;">
                        <HxInputText Label="Curso Escolar *" @bind-Value="@form.schoolYear" Placeholder="2024/2025"></HxInputText>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6" style="text-align:center;">
                        <HxInputText Label="Día de Preferencia *" @bind-Value="@form.preferenceDay" Placeholder="A confirmar por el centro"></HxInputText>
                    </div>
                    <div class="col-sm-6" style="text-align:center;">
                        <HxInputText Label="Hora de Preferencia *" @bind-Value="@form.preferenceSchedule" Placeholder="A confirmar por el centro"></HxInputText>

                    </div>
                </div>
                <div class="row" style="text-align:center">
                    <div class="col-sm-12">
                        <HxCheckbox Label="¿Su hijo/a tiene que pagar matrícula? *" @bind-Value="@form.paid"></HxCheckbox>

                    </div>
                </div>
                <div class="row" style="text-align:center">
                    <div class="col-sm-12">
                        <HxSubmit Text="Siguiente" Color="ThemeColor.Primary" OnClick="() =>SendForm(form,0)"></HxSubmit>
                    </div>
                </div>
            }
            @if(stepForm == 1)
            {
                <div class="row">
                    <div class="col-sm-6" style="text-align:center;">
                        <HxInputText Label="@(_labelParentName)" @bind-Value="form.nameparent"></HxInputText>
                    </div>
                    <div class="col-sm-6" style="text-align:center;">
                        <HxInputText Label="NIF/NIE *" @bind-Value="form.nationalId"></HxInputText>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6" style="text-align:center;">
                        <HxInputText Label="Nombre y apellidos de madre/padre/tutor legal" @bind-Value="form.nameparent2"></HxInputText>
                    </div>
                    <div class="col-sm-6" style="text-align:center;">
                        <HxInputText Label="NIF/NIE" @bind-Value="form.nationalId2"></HxInputText>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6" style="text-align:center;">
                        <HxInputText Label="Teléfono madre/padre/tutor legal *" @bind-Value="form.phoneNumber"></HxInputText>
                    </div>
                    <div class="col-sm-6" style="text-align:center;">
                        <HxInputText Label="Teléfono madre/padre/tutor legal" @bind-Value="form.phoneNumber2"></HxInputText>

                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6" style="text-align:center;">
                        <HxInputText Label="Correo electrónico *" @bind-Value="form.email"></HxInputText>
                    </div>
                    <div class="col-sm-6" style="text-align:center;">
                        <HxInputText Label="Correo electrónico 2" @bind-Value="form.email2"></HxInputText>

                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6" style="text-align:center;">
                        <HxInputText Label="Direción *" @bind-Value="form.address"></HxInputText>
                    </div>
                    <div class="col-sm-6" style="text-align:center;">
                        <HxInputText Label="Ciudad *" @bind-Value="form.city"></HxInputText>

                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6" style="text-align:center;">
                        <HxInputText Label="Provincia *" @bind-Value="form.province"></HxInputText>
                    </div>
                    <div class="col-sm-6" style="text-align:center;">
                        <HxInputText Label="Código Postal *" @bind-Value="form.cp"></HxInputText>

                    </div>
                </div>
                <div class="row" style="text-align:center">
                    <div class="col-sm-6">
                        <HxSubmit Text="Retroceder" Color="ThemeColor.Danger" OnClick="() =>ReturnForm(form,1)" Icon="BootstrapIcon.ArrowLeft"></HxSubmit>
                    </div>
                    <div class="col-sm-6">
                        <HxSubmit Text="Siguiente" Color="ThemeColor.Primary" OnClick="() =>SendForm(form,1)" Icon="BootstrapIcon.ArrowRight"></HxSubmit>
                    </div>
                </div>

            }
            @if(stepForm == 2)
            {
                <div class="row">
                    <div class="col-sm-6">
                        <HxCheckbox Label="Mi hijo/a puede ir solo a casa *" @bind-Value="@form.goHome"></HxCheckbox>
                    </div>
                    <div class="col-sm-6">
                        <HxCheckbox Label="Mi hijo/a tiene alergias *" @bind-Value="@form.alergias"></HxCheckbox>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <HxCheckbox Label="Durante el curso queremos utilizar Whatsapp (listas de difusión) y email como herramienta de comunicacion para informarnos de actualizaciones y novedades en el curso de vuestros hijos, estoy de acuerdo: *" @bind-Value="@form.whatsapp"></HxCheckbox>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <HxCheckbox Label="En ocasiones, es posible que durante el desarrollo de una clase, o en el marco de una fiesta fin de curso, navideña, etc., o una excursión, se tomen fotos de los niños. Estoy de acuerdo con que mi hijo/a pueda aparecer en estas fotos, y que éstas puedan estar colocadas en los tablones del Learning Centre, y en los perfiles de redes sociales: *" @bind-Value="@form.photos"></HxCheckbox>
                    </div>

                </div>
                <div class="row" style="text-align:center">
                    <div class="col-sm-12">
                        <HxCheckbox Label="Acepto el envío de comunicaciones comerciales, tanto por la escuela como la franquiciadora *" @bind-Value="@form.commercialCommunications"></HxCheckbox>

                    </div>
                </div>
                <div class="row" style="text-align:center">
                    <h5>¿Cómo nos has conocido?</h5>

                    <div class="col-sm-12">
                        <HxSelect TItem="HowMeetUs"
                                  TValue="string"
                                  Data="dataHowMeetus"
                                  @bind-Value="method"
                                  TextSelector="@(x => x.via)"
                                  ValueSelector="@(x => x.via)"
                                  Nullable="true"
                                  NullText="- Seleccione uno -"
                                  NullDataText="Cargando métodos..." />
                    </div>
                </div>
                <div class="row" style="text-align:center">
                    <div class="col-sm-6">
                        <HxSubmit Text="Retroceder" Color="ThemeColor.Danger" OnClick="() =>ReturnForm(form,2)" Icon="BootstrapIcon.ArrowLeft"></HxSubmit>
                    </div>
                    <div class="col-sm-6">
                        <HxSubmit Text="Siguiente" Color="ThemeColor.Primary" OnClick="() =>SendForm(form,2)" Icon="BootstrapIcon.ArrowRight"></HxSubmit>
                    </div>
                </div>

            }
            @if(stepForm == 3)
            {
                <div class="row">
                    <div class="col-sm-12" style="text-align:center;">
                        <h5>Tratamientos de datos *</h5>
                        <HxInputTextArea @bind-Value="@form.dataProcessing"></HxInputTextArea>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12" style="text-align:center;">
                        <h5>Cláusalas adicionales *</h5>
                        <HxInputTextArea @bind-Value="@form.additionalClauses"></HxInputTextArea>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <HxCheckbox Label="He leído y autorizo a realizar el tratamiento de datos arriba descrito *" @bind-Value="@form.authorizationDataProcessing"></HxCheckbox>
                    </div>

                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <HxCheckbox Label="Acepto las cláusulas adicionales *" @bind-Value="@form.authorizationAdditionalClauses"></HxCheckbox>

                    </div>
                </div>
                <div class="row" style="text-align:center">
                    <div class="col-sm-6">
                        <HxSubmit Text="Retroceder" Color="ThemeColor.Danger" OnClick="() =>ReturnForm(form,3)" Icon="BootstrapIcon.ArrowLeft"></HxSubmit>
                    </div>
                    <div class="col-sm-6">
                        <HxSubmit Text="Siguiente" Color="ThemeColor.Primary" OnClick="() =>SendForm(form,3)" Icon="BootstrapIcon.ArrowRight"></HxSubmit>
                    </div>
                </div>

            }
            @if(stepForm == 4)
            {
                <div class="row">
                    <div class="col-sm-12" style="text-align:center;">
                        <h5>Información a tener en cuenta(situación familiar, etc.) *</h5>
                        <HxInputTextArea @bind-Value="@form.additionalInformation"></HxInputTextArea>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12" style="text-align:center;">
                        <h5>Personas que pueden recoger de clase a mi hijo/a (nombre/parentesco) *</h5>
                        <HxInputTextArea @bind-Value="@form.morePeople"></HxInputTextArea>

                        <h3><strong>Se ruega informar antes de la clase si alguien distinto de los padres/tutores legales pasará a recoger al/el menor)</strong></h3>
                    </div>
                </div>
                <div class="row">
                    <h3>Método de pago *</h3>
                    <div class="col-sm-4">
                        <HxCheckbox Label="Pago Mensual" @bind-Value="form.monthlyPayment"></HxCheckbox>
                    </div><div class="col-sm-4">
                        <HxCheckbox Label="Pago Trimestral (5% dto. por trimestre)" @bind-Value="form.quarterlyPayment"></HxCheckbox>
                    </div><div class="col-sm-4">
                        <HxCheckbox Label="Pago Anual (10% dto. anual)" @bind-Value="form.annualPayment"></HxCheckbox>
                    </div>
                </div>
                <div class="row">
                    <HxIcon Icon="@BootstrapIcon.CashCoin"></HxIcon><h3>Forma de pago</h3>
                    <div class="col-sm-6" style="text-align:center;">
                        <HxCheckbox Label="Cargo a cuenta" @bind-Value="form.bank"></HxCheckbox>

                    </div>
                    <div class="col-sm-6" style="text-align:center;">
                        <HxCheckbox Label="Otro" @bind-Value="form.other"></HxCheckbox>

                    </div>
                </div>
                @if(form.bank)
                {
                    <div class="row">
                        <div class="col-sm-12">
                            <HxInputText @bind-Value="@form.iban" Label="Introduzca el número de cuenta corriente:"></HxInputText>
                        </div>

                    </div>
                }
                <div class="row">
                    <div class="col-sm-12">
                        <HxInputText @bind-Value="@form.anotherHolder" Label="En el caso de que el titular de la cuenta sea distinto del padre/madre/tutor legal, indique nombre y apellidos del titular:"></HxInputText>
                    </div>

                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <HxCheckbox Label="Acepto el aviso legal y la política de privacidad *" @bind-Value="@form.privacyPolicy"></HxCheckbox>
                    </div>
                </div>

                <div class="row" style="text-align:center">
                    <div class="col-sm-6">
                        <HxSubmit Text="Retroceder" Color="ThemeColor.Danger" OnClick="() =>ReturnForm(form,4)" Icon="BootstrapIcon.ArrowLeft"></HxSubmit>
                    </div>
                    <div class="col-sm-6">
                        <HxSubmit Text="Siguiente" Color="ThemeColor.Primary" OnClick="() =>SendForm(form,4)" Icon="BootstrapIcon.ArrowRight"></HxSubmit>
                    </div>
                </div>
            }

        </div>


    </div>
</div>

<HxModal @ref="emptyForm" Centered="true">
    <HeaderTemplate>
        <strong><h3>Formulario incorrecto</h3></strong>
    </HeaderTemplate>
    <BodyTemplate>
        <HxAlert Color="ThemeColor.Danger">Por favor, revise que ha rellenado todos los campos obligatorios.</HxAlert>
    </BodyTemplate>
    <FooterTemplate>
        <HxButton Text="Confirmar" OnClick=" () => emptyForm.HideAsync()" Color="ThemeColor.Primary" />
    </FooterTemplate>
</HxModal>







